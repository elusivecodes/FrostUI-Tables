!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:e(t)}(window,(function(t){"use strict";if(!t)throw new Error("FrostUI-Tables requires a Window.");if(!("UI"in t))throw new Error("FrostUI-Tables requires FrostUI.");const e=t.Core,s=t.dom,i=(t.QuerySet,t.UI),n=t.document;class r extends i.BaseComponent{constructor(t,i){let n;super(t,i),i&&i.layout&&Object.assign(this._settings.layout,i.layout),this._data=[],this._getData=null,this._getResults=null,e.isFunction(this._settings.getResults)?(this._getResultsCallbackInit(),this._getResultsInit()):n=e.isArray(this._settings.data)?this._settings.data:this.constructor._getDataFromDOM(this._node),n&&(this._data=n,this._getDataInit()),this._headings=this.constructor._getHeadingsFromDOM(this._node),this._columns=[],this._settings.columns?this._columns=this._settings.columns:this._columns=new Array(this._headings.length).fill(),this._columns=this._columns.map(((t,e)=>({class:null,data:e,dir:"asc",format:null,name:null,orderData:null,orderable:!0,searchable:!0,visible:!0,...t}))),this._columnCount=this._columns.reduce(((t,e)=>(e.visible&&t++,t)),0),this._offset=0,this._limit=this._settings.paging?this._settings.length:Number.INFINITY,this._order=this._settings.order.slice(),this._term=null,this._buildIndex(),this._render(),this._events(),s.triggerEvent(this._node,"init.ui.table"),this._getData()}dispose(){s.before(this._container,this._node),s.remove(this._container),s.empty(this._node);for(const t of s.children(this._original))s.append(this._node,t);this._original=null,this._container=null,this._loader=null,this._thead=null,this._tbody=null,this._tfoot=null,this._infoContainer=null,this._pagination=null,this._lengthSelect=null,this._searchInput=null,this._columns=null,this._headings=null,this._order=null,this._data=null,this._index=null,this._filterIndexes=null,this._rowIndexes=null,this._request=null,super.dispose()}info(){return{end:this._offset+this._limit,filtered:this._filtered,start:this._offset,total:this._total}}length(t){return this._settings.paging&&(this._limit=t,this._offset-=this._offset%this._limit,s.triggerEvent(this._node,"length.ui.table"),this._getData()),this}loading(t=!0){return t?(s.triggerEvent(this._node,"processing.ui.table"),s.show(this._loader)):(s.hide(this._loader),s.triggerEvent(this._node,"processed.ui.table")),this}order(t){return this._settings.ordering&&(this._order=t,s.triggerEvent(this._node,"order.ui.table"),this._getData()),this}page(t){return this._settings.paging&&(this._offset=(t-1)*this._limit,s.triggerEvent(this._node,"page.ui.table"),this._getData()),this}refresh(){return this._renderResults(),this}reload(t=!1){return t&&(this._offset=0),this._getData(),this}search(t){if(this._settings.searching){if(s.setValue(this._searchInput,t),this._term=t,s.triggerEvent(this._node,"search.ui.table"),this._term){this._filterIndexes=[];const t=e.escapeRegExp(this._term),s=new RegExp(t,"i");for(const[t,i]of this._data.entries())for(const n of this._columns){if(!n.searchable)continue;const r=e.getDot(i,`${n.data}`);s.test(r)&&this._filterIndexes.push(t)}this._filtered=this._filterIndexes.length}else this._filterIndexes=null,this._filtered=this._total;this._getData()}return this}}r.buttons={csv(t){t.title||(t.title=s.getText("title")),t.columns||(t.columns=this._getVisibleColumns());const e=[this._getHeadings(t.columns),...this._getResultRows(t.columns)],i=[];for(const t of e){const e=t.map((t=>(t=`${t}`.replace(/"/g,'""')).indexOf(",")>=0?`"${t}"`:t)).join(",");i.push(e)}const n=new Blob([i.join("\r\n")],{type:"text/csv;charset=utf-8;"});this._saveBlob(n,`${t.title}.csv`)},excel(t){t.title||(t.title=s.getText("title")),t.columns||(t.columns=this._getVisibleColumns());const e=new o;e.addSheet({header:this._getHeadings(t.columns),rows:this._getResultRows(t.columns)});const i=e.create();this._saveBlob(i,`${t.title}.xlsx`)},print(e){e.title||(e.title=s.getText("title")),e.columns||(e.columns=this._getVisibleColumns());const i=t.open("","");i.document.head.innerHTML=`<title>${e.title}</title>`;const r=s.find("link, style"),o=s.clone(r);for(const t of o){if("link"===s.tagName(t)){const e=s.getAttribute(t,"href"),i=new URL(e,n.location).href;s.setAttribute(t,"href",i)}i.document.head.appendChild(t)}const a=s.create("div"),l=this._buildTable(e.columns),h=s.getAttribute(this._node,"class");s.addClass(l,h),s.append(a,l);const c=s.getHTML(a);i.document.body.innerHTML=`<h1>${e.title}</h1>${c}`,setTimeout((t=>{i.print(),i.close()}),1e3)}},Object.assign(r.prototype,{addRow(t){return this._data.push(t),this._getResults&&this._rowIndexes.push(this._data.length-1),this._buildIndex(),this},clear(){return this._data=[],this._index=[],this._filterIndexes=[],this._rowIndexes=[],this},getColumn(t){return this._data.map((s=>e.getDot(s,t)))},getRow(t){return this._data[t]},getValue(t,s){return e.getDot(this._data[t],s)},hideColumn(t){return this._columns[t].visible=!1,this},removeRow(t){return this._data=this._data.filter(((e,s)=>s!==t)),this._buildIndex(),this},setColumn(t,s){return this._data=this._data.map(((i,n)=>(e.setDot(i,t,s[n]),i))),this._buildIndex(),this},setRow(t,e){return this._data[t]=e,this._buildIndex(),this},setValue(t,s,i){return e.setDot(this._data[t],s,i),this._buildIndex(),this},showColumn(t){return this._columns[t].visible=!0,this}}),Object.assign(r.prototype,{_events(){if(this._settings.lengthChange&&s.addEvent(this._lengthSelect,"change.ui.table",(t=>{const e=s.getValue(t.currentTarget);this.length(e)})),this._settings.searching){const t=e.debounce((t=>{this.search(t)}),this._settings.debounceInput);s.addEvent(this._searchInput,"input.ui.table",(e=>{const i=s.getValue(e.currentTarget);t(i)}))}this._settings.ordering&&s.addEventDelegate(this._thead,"click.ui.table","th",(t=>{t.preventDefault();const e=s.index(t.currentTarget);if(!this._columns[e].orderable)return;const i=this._columns[e].dir;let n=null;for(const[t,s]of this._order)if(t==e){n=s;break}let r,o=i;n===i&&(o="asc"===i?"desc":"asc"),r=t.shiftKey?n?n===i?this._order.map((([t,s])=>(t==e&&(s=o),[t,s]))):this._order.filter((([t])=>t!=e)):[...this._order,[e,o]]:[[e,o]],this.order(r)})),this._settings.paging&&s.addEventDelegate(this._pagination,"click.ui.table","[data-ui-page]",(t=>{t.preventDefault();const e=s.getDataset(t.currentTarget,"uiPage");this.page(e)}))}}),Object.assign(r.prototype,{_buildTable(t){const e=this._getHeadings(t),i=this._getResultRows(t),n=s.create("table"),r=s.create("thead"),o=s.create("tr");for(const t of e){const e=s.create("th",{text:t});s.append(o,e)}s.append(r,o),s.append(n,r);const a=s.create("tbody");for(const t of i){const e=s.create("tr");for(const i of t){const t=s.create("td",{text:i});s.append(e,t)}s.append(a,e)}return s.append(n,a),n},_getHeadings(t){const e=[];for(const[s,i]of this._headings.entries())t.includes(s)&&e.push(i.text);return e},_getResultRows(t){const s=[];for(const i of this._results){const n=[];for(const[s,r]of this._columns.entries()){if(!t.includes(s))continue;const o=e.getDot(i,`${r.data}`);n.push(o)}s.push(n)}return s},_getVisibleColumns(){const t=[];for(const[e,s]of this._columns.entries()){if(!s.visible)return;t.push(e)}return t},_saveBlob(t,e){const i=s.create("a",{attributes:{href:URL.createObjectURL(t),download:e}});s.append(n.body,i),s.click(i),s.detach(i)}}),Object.assign(r.prototype,{_buildIndex(){if(!this._getResults&&this._settings.ordering){this._index=[];for(const t of this._columns){if(!t.orderable)return!1;this._index[t.data]=[];const s={};for(const[i,n]of this._data.entries()){const r=e.getDot(n,`${t.data}`);r in s||(s[r]=[]),s[r].push(i)}const i=Object.keys(s).sort(((t,s)=>{if(e.isNumeric(t)&&e.isNumeric(s))return t-s;const i=t.toLowerCase(),n=s.toLowerCase();return i.localeCompare(n)}));for(const e of i)this._index[t.data].push(s[e])}}},_getOrder(){const t=[];for(const[e,s]of this._order)this._columns[e].orderData?t.push(...this._columns[e.orderData]):t.push([e,s]);return t},_getOrderedIndexes(t,e=null,s=this._offset,i=this._limit,n=0){const[r,o]=t[n],a=this._columns[r].data;let l=this._index[a];"desc"===o&&(l=l.slice().reverse());let h=0;const c=[];for(const r of l){let a=e?r.filter((t=>e.includes(t))):r;if("desc"===o&&(a=a.slice().reverse()),s>h+a.length||!a.length){h+=r.length;continue}const l=a.length>1&&n<t.length-1?this._getOrderedIndexes(t,a,0,Math.min(a.length,i-c.length),n+1):r;for(const t of l)if(h++,!(h<=s)&&(c.push(t),c.length==i))return c}return c}}),Object.assign(r.prototype,{_getDataInit(){this._total=this._data.length,this._filtered=this._total,this._getData=t=>{if(this.loading(),this._rowIndexes=this._filterIndexes,this._settings.ordering){const t=this._getOrder();this._rowIndexes=this._getOrderedIndexes(t,this._rowIndexes)}this._results=[],this._rowIndexes||(this._rowIndexes=e.range(this._offset,this._offset+this._limit));for(const t of this._rowIndexes)this._results.push(this._data[t]);this.loading(!1),this._renderResults()}},_getResultsInit(){this._getData=t=>{this._request&&this._request.cancel&&(this._request.cancel(),this._request=null);const s={};this._term&&(s.term=this._term),this._settings.ordering&&(s.order=this._order.map((([t,e])=>({column:t,dir:e})))),this._settings.paging&&(s.offset=this._offset,s.limit=this._limit),s.columns=this._columns.map((t=>({data:t.data,name:t.name,orderable:t.orderable,searchable:t.searchable}))),this.loading();const i=this._getResults(s);i.then((t=>{this._request===i&&(this._total=t.total,this._filtered=t.filtered,this._data=this._results=t.results,this._rowIndexes=e.range(0,this._results.length-1),this.loading(!1),this._renderResults())})).catch((t=>{this.loading(!1)})).finally((t=>{this._request===i&&(this._request=null)}))}},_getResultsCallbackInit(){this._getResults=t=>{const e=this._settings.getResults(t);return this._request=Promise.resolve(e),this._request.then((t=>(this._data=t.results,t))),this._request}}}),Object.assign(r.prototype,{_render(){this._original=s.clone(this._node),s.empty(this._node),this._container=s.create("div",{class:this.constructor.classes.container}),this._loader=s.create("div",{class:this.constructor.classes.loader});const t=s.create("span",{class:this.constructor.classes.loaderIcon});s.append(this._loader,t),s.addClass(this._node,this.constructor.classes.table),this._thead=s.create("thead"),s.append(this._node,this._thead),this._tbody=s.create("tbody"),s.append(this._node,this._tbody),s.findOne("tfoot",this._original)&&(this._tfoot=s.create("tfoot"),s.append(this._node,this._tfoot)),s.hide(this._loader),s.after(this._node,this._container),s.append(this._container,this._loader),this._settings.layout.top&&this._renderLayoutRow(this._settings.layout.top,this.constructor.classes.topRow),s.append(this._container,this._node),this._settings.layout.bottom&&this._renderLayoutRow(this._settings.layout.bottom,this.constructor.classes.bottomRow)},_renderButtons(t){const e=s.create("div",{class:this.constructor.classes.buttonGroup});for(const t of this._settings.buttons){const i=s.create("button",{class:this.constructor.classes.button,text:!t.text&&t.type in this._settings.lang.buttons?this._settings.lang.buttons[t.type]:t.text});s.addEvent(i,"click.ui.table",(e=>{e.preventDefault(),t.callback?t.callback.bind(this)():t.type in this.constructor.buttons&&this.constructor.buttons[t.type].bind(this)(t)})),s.append(e,i)}s.append(t,e)},_renderHeadings(){s.empty(this._thead);const t=s.create("tr");for(const[e,i]of this._headings.entries()){if(!this._columns[e].visible)continue;const n=s.create("th",{class:this.constructor.classes.tableHeading,html:i.text});if(i.class&&s.addClass(n,i.class),s.append(t,n),!this._settings.ordering||!this._columns[e].orderable)continue;const r=[this.constructor.classes.tableSort];let o;for(const t of this._order){if(t[0]!=e)continue;const i=s.getText(n);"asc"==t[1]?(r.push(this.constructor.classes.tableSortAsc),o=`${i}${this._settings.lang.aria.sortDescending}`):(r.push(this.constructor.classes.tableSortDesc),o=`${i}${this._settings.lang.aria.sortAscending}`)}s.addClass(n,r),o&&s.setAttribute(n,"aria-label",o)}s.append(this._thead,t)},_renderInfo(){s.empty(this._infoContainer);const t=this._offset+1,e=this._offset+this._results.length;let i=this._filtered<this._total?this._settings.lang.infoFiltered:this._settings.lang.info;const n={start:t,end:e,filtered:this._filtered,total:this._total};for(const[t,e]of Object.entries(n))i=i.replace(`{${t}}`,e);this._settings.infoCallback&&(i=this._settings.infoCallback(t,e,this._total,this._filtered,r));const r=s.create("small",{text:i});s.append(this._infoContainer,r)},_renderInfoContainer(t){this._infoContainer=s.create("div",{class:this.constructor.classes.infoContainer}),s.append(t,this._infoContainer)},_renderLayoutRow(t,e){const i=s.create("div",{class:e});for(const e of t.split(",")){const t=s.create("div",{class:this.constructor.classes.column});for(const i of e.split("|")){if(!(i in this.constructor.layout))continue;const e=s.create("div",{class:this.constructor.classes.columnContainer});this.constructor.layout[i].bind(this)(e),s.append(t,e)}s.append(i,t)}s.append(this._container,i)},_renderLengthSelect(t){if(!this._settings.lengthChange||!this._settings.paging)return;const e=s.create("div",{class:this.constructor.classes.lengthContainer}),i=s.create("label",{class:this.constructor.classes.lengthLabel});s.append(e,i);const n=s.create("small",{class:this.constructor.classes.lengthLabelText,text:this._settings.lang.perPage});s.append(i,n);const r=s.create("div",{class:this.constructor.classes.lengthInputContainer,style:{width:"initial"}});s.append(i,r),this._lengthSelect=s.create("select",{class:"filled"===this._settings.inputStyle?this.constructor.classes.lengthInputFilled:this.constructor.classes.lengthInputOutline}),s.append(r,this._lengthSelect);for(const t of this._settings.lengths){const e=s.create("option",{value:t,text:t});t==this._limit&&s.setAttribute(e,"checked",!0),s.append(this._lengthSelect,e)}if("filled"===this._settings.inputStyle){const t=s.create("div",{class:this.constructor.classes.lengthInputRipple});s.append(r,t)}s.append(t,e)},_renderPageItem(t){const e=s.create("div",{class:this.constructor.classes.pageItem}),i=s.create("button",{html:t.icon||t.text||t.page,class:this.constructor.classes.pageLink,attributes:{type:"button",title:t.text?`${t.text} ${this._settings.lang.page}`:`${this._settings.lang.page} ${t.page}`}});return s.append(e,i),t.disabled&&(s.addClass(e,this.constructor.classes.pageDisabled),s.setAttribute(i,"aria-disabled","true"),s.setAttribute(i,"tabindex","-1")),t.active&&s.addClass(e,this.constructor.classes.pageActive),t.page&&s.setDataset(i,"uiPage",t.page),e},_renderPagination(){const t=Math.ceil(this._filtered/this._limit),e=1+this._offset/this._limit;s.empty(this._pagination);const i=this._renderPageItem({text:this._settings.lang.paginate.first,icon:this._settings.icons.first,disabled:1==e,page:1});s.append(this._pagination,i);const n=this._renderPageItem({text:this._settings.lang.paginate.previous,icon:this._settings.icons.previous,disabled:1==e,page:e>1?e-1:null});s.append(this._pagination,n);let r=Math.max(e-5,1),o=Math.min(e+5,t);for(;o-r>4;)e-r>o-e?r++:o--;for(let t=r;t<=o;t++){const i=this._renderPageItem({page:t,active:t==e});s.append(this._pagination,i)}const a=this._renderPageItem({text:this._settings.lang.paginate.next,icon:this._settings.icons.next,disabled:e==t,page:e<t?e+1:null});s.append(this._pagination,a);const l=this._renderPageItem({text:this._settings.lang.paginate.last,icon:this._settings.icons.last,disabled:e==t,page:t});s.append(this._pagination,l)},_renderPaginationContainer(t){const e=s.create("div",{class:this.constructor.classes.paginationContainer});s.append(t,e),this._pagination=s.create("div",{class:this.constructor.classes.pagination}),s.append(e,this._pagination)},_renderResults(){if(s.triggerEvent(this._node,"preDraw.ui.table"),s.empty(this._tbody),this._renderHeadings(),this._settings.headerCallback&&this._settings.headerCallback(this._head,this._data,this._offset,this._offset+this._limit,this._rowIndexes),this._settings.paging&&this._renderPagination(),this._settings.info&&this._renderInfo(),this._results.length)for(const[t,e]of this._results.entries()){const i=this._renderRow(e);this._settings.rowCallback&&this._settings.rowCallback(i,e,t,this._offset+t,this._rowIndexes[t]),s.append(this._tbody,i),this._settings.createdRow&&this._settings.createdRow(i,e,t)}else{const t=s.create("tr"),e=s.create("td",{class:this.constructor.classes.emptyCell,html:this._term?this._settings.lang.noResults:this._settings.lang.noData,attributes:{colspan:this._columnCount}});s.append(t,e),s.append(this._tbody,t)}this._settings.drawCallback&&this._settings.drawCallback(),this._tfoot&&this._settings.footerCallback&&this._settings.footerCallback(this._tfoot,this._data,this._offset,this._offset+this._limit,this._rowIndexes),s.triggerEvent(this._node,"draw.ui.table")},_renderRow(t){const i=s.create("tr");for(const n of this._columns){if(!n.visible)continue;const r=e.getDot(t,`${n.data}`),o=s.create("td",{html:n.format?n.format(r):r});n.class&&s.addClass(n.class),s.append(i,o)}return i},_renderSearch(t){if(!this._settings.searching)return;const e=s.create("div",{class:this.constructor.classes.searchContainer}),i=s.create("div",{class:this.constructor.classes.searchInputContainer,style:{width:"200px"}});if(s.append(e,i),this._searchInput=s.create("input",{class:"filled"===this._settings.inputStyle?this.constructor.classes.searchInputFilled:this.constructor.classes.searchInputOutline,attributes:{type:"text",placeholder:this._settings.lang.search}}),s.append(i,this._searchInput),"filled"===this._settings.inputStyle){const t=s.create("div",{class:this.constructor.classes.searchInputRipple});s.append(i,t)}s.append(t,e)}}),Object.assign(r,{_getDataFromDOM(t){const e=s.findOne("tbody",t);return s.children(e,"tr").map((t=>s.children(t,"td").map((t=>s.getHTML(t)))))},_getHeadingsFromDOM(t){const e=s.findOne("thead",t),i=s.children(e,"tr").shift();return s.children(i,"th").map((t=>({text:s.getHTML(t),class:s.getAttribute(t,"class")})))}}),r.defaults={buttons:[],layout:{top:"search,buttons|length",bottom:"info,pagination"},lang:{info:"Showing results {start} to {end} of {total}",infoFiltered:"Showing results {start} to {end} of {filtered} (filtered from {total} total)",noData:"No data available",noResults:"No results to show",page:"Page",perPage:"Per Page",search:"Search",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"},buttons:{csv:"CSV",excel:"Excel",print:"Print"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}},icons:{first:"&laquo;",last:"&raquo",next:"&gt;",previous:"&lt;"},inputStyle:"filled",createdRow:null,drawCallback:null,footerCallback:null,headerCallback:null,infoCallback:null,preDrawCallback:null,rowCallback:null,columns:null,order:[[0,"asc"]],lengths:[10,25,50,100],length:10,debounceInput:250,info:!0,lengthChange:!0,ordering:!0,paging:!0,searching:!0},r.classes={bottomRow:"d-md-flex justify-content-between mx-n2",button:"btn btn-outline-secondary",buttonGroup:"btn-group btn-group-sm mt-1",column:"d-md-flex",columnContainer:"text-center px-2 mb-1",container:"position-relative mb-2",emptyCell:"text-center py-3",infoContainer:"text-center text-md-start mb-2 mb-md-0 w-100",lengthContainer:"d-flex justify-content-center justify-content-md-start w-100 mb-1",lengthInputContainer:"form-input d-inline-block",lengthInputFilled:"input-filled input-sm",lengthInputOutline:"input-outline input-sm",lengthInputRipple:"ripple-line",lengthLabel:"mb-1 mb-md-0",lengthLabelText:"me-2",loader:"position-absolute top-50 start-50 translate-middle",loaderIcon:"spinner-border text-primary",pageActive:"active",pageDisabled:"disabled",pageItem:"page-item",pageLink:"page-link ripple",pagination:"pagination pagination-sm mx-auto me-md-0",paginationContainer:"d-flex w-100",searchContainer:"w-100 mb-1",searchInputContainer:"form-input mx-auto me-md-0",searchInputFilled:"input-filled input-sm",searchInputOutline:"input-outline input-sm",searchInputRipple:"ripple-line",table:"table table-bordered",tableHeading:"fw-bold",tableSort:"table-sort",tableSortAsc:"table-sort-asc",tableSortDesc:"table-sort-desc",topRow:"d-md-flex justify-content-between mb-2 mx-n2"},r.layout={buttons(t){this._renderButtons(t)},search(t){this._renderSearch(t)},length(t){this._renderLengthSelect(t)},info(t){this._renderInfoContainer(t)},pagination(t){this._renderPaginationContainer(t)}},i.initComponent("table",r),i.Table=r;class o{constructor(){this._current=0,this._sheets=[],this._sKeys={},this._sValues=[]}addSheet(t,e=null){return this._current++,e||(e=`Sheet${this._current}`),this._sheets.push({name:e,data:t}),this}create(){const t=new u("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");for(let[e,s]of Object.entries(this.constructor.templates))switch(e){case"[Content_Types].xml":const i=this._sheets.map(((t,e)=>`<Override PartName="/xl/worksheets/sheet${e+1}.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>`)).join("");s=s.replace("{sheets}",i),t.addFile(e,s);break;case"xl/_rels/workbook.xml.rels":let n=this._sheets.map(((t,e)=>`<Relationship Id="rId${e+2}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet${e+1}.xml"/>\n`)).join("");n+=`<Relationship Id="rId${this._sheets.length+3}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/></Relationships>`,s=s.replace("{sheets}",n),t.addFile(e,s);break;case"xl/workbook.xml":const r=this._sheets.map(((t,e)=>`<sheet name="${t.name}" sheetId="${e+1}" state="visible" r:id="rId${e+2}"/>`));s=s.replace("{sheets}",r),t.addFile(e,s);break;case"docProps/core.xml":const o=(new Date).toISOString().substring(0,19)+"Z";s=s.replaceAll("{date}",o),t.addFile(e,s);break;case"xl/sharedStrings.xml":this._sValues.length||this._sValues.push("No Data");const a=this._sValues.map((t=>`<si><t>${t}</t></si>`)).join("\r\n");s=s.replaceAll("{cnt}",`${this._sValues.length}`),s=s.replace("{strings}",a),t.addFile(e,s);break;case"xl/worksheets/sheet1.xml":for(const[i,n]of this._sheets.entries()){e=`xl/worksheets/sheet${i+1}.xml`;const r=this._sheetToXml(n,s);t.addFile(e,r)}break;default:t.addFile(e,s)}return t.zip()}_sheetToXml(t,e){const s={},i=[],n=[];let r=0;const o=(t,e=null)=>{r++;let i=`<row r="${r}">`,o=0;for(let n of t){if(o++,1===r&&(s[o]=0),!n)continue;const t=this.constructor._colName(o)+r;n=`${n}`;const a=n.length;let l,h,c;if("0"===n||/^[-+]?[1-9]\d{0,14}$/.test(n))c=n.trimStart("+"),a>10&&(h=1);else if(/^[-+]?(?:0|[1-9]\d*)\.\d+$/.test(n))c=n.trimStart("+");else if(/^[-+]?\d+%$/.test(n))n=parseInt(n)/100,c=n.toFixed(2),h=2;else if(/^[-+]?\d+\.\d+%$/.test(n))n=Math.round(100*parseFloat(n))/1e4,c=n.toFixed(4),h=3;else if(/^\d{4}-\d{2}-\d{2}$/.test(n)){const t=n.match(/^(\d{4})-(\d{2})-(\d{2})$/);c=this.constructor._date(t[1],t[2],t[3]),h=4}else if(/^\d{2}\/\d{2}\/\d{4}$/.test(n)){const t=n.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);c=this.constructor._date(t[3],t[2],t[1]),h=4}else if(/\d{2}:\d{2}:\d{2}$/.test(n)){const t=n.match(/(\d{2}):(\d{2}):(\d{2})$/);c=this.constructor._date(0,0,0,t[1],t[2],t[3]),h=5}else if(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(n)){const t=n.match(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})$/);c=this.constructor._date(t[1],t[2],t[3],t[4],t[5],t[6]),h=6}else if(/^\d{2}\/\d{2}\/\d{4} \d{2}:\d{2}:\d{2}$/.test(n)){const t=n.match(/^(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})$/);c=this.constructor._date(t[3],t[2],t[1],t[4],t[5],t[6]),h=6}else if(a>160)l="inlineStr",c=this.constructor._escape(n);else{/^[0-9+-.]+$/.test(n)&&(h=7),l="s",n=n.trimStart("\0"),n=this.constructor._escape(n);const t=`~${n}`;t in this._sKeys?c=this._sKeys[t]:(this._sValues.push(n),c=this._sValues.length-1,this._sKeys[t]=c)}s[o]=Math.max(a,s[o]);const d={r:t};l&&(d.t=l),e&&(h=e),h&&(d.s=h),i+=`<c ${Object.keys(d).map((t=>`${t}="${d[t]}"`)).join(" ")}>`+("inlineStr"===l?`<is><t>${c}</t></is>`:`<v>${c}</v>`)+"</c>"}i+="</row>",n.push(i)};if(t.data.header&&o(t.data.header,8),t.data.rows)for(const e of t.data.rows)o(e);t.data.footer&&o(t.data.footer,8);for(const[t,e]of Object.entries(s))i.push(`<col min="${t}" max="${t}" width="${Math.min(e+5,60)}" />`);const a=`A1:${this.constructor._colName(i.length)}${n.length}`;return e=(e=(e=e.replace("{ref}",a)).replace("{cols}",i.join("\r\n"))).replace("{rows}",n.join("\r\n"))}}Object.assign(o,{_colName(t){const e=65+(t-1)%26,s=String.fromCharCode(e),i=Math.round((t-1)/26);return i>0?this._colName(i)+s:s},_date(t,e,s,i=0,n=0,r=0){if(!t)return(3600*i+60*n+r)/86400;let o=1;1900==t&&e<=2&&(o=0),e>2?e-=3:(e+=9,t--);const a=t.substring(0,2),l=t.substring(2);return Math.floor(146097*a/4)+Math.floor(1461*l/4)+Math.floor(153*(e+2)/5)+s+1721119-2415020+o},_escape:t=>t=(t=(t=(t=t.replace("&","&amp;")).replace("<","&lt;")).replace(">","&gt;")).replace("","")}),o.templates={"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Override PartName="/_rels/.rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/xl/_rels/workbook.xml.rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>{sheets}<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/></Types>',"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/></Relationships>',"docProps/app.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><TotalTime>0</TotalTime><Application>FrostUI-Tables</Application></Properties>',"docProps/core.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dcterms:created xsi:type="dcterms:W3CDTF">{date}</dcterms:created><dc:language>en-US</dc:language><dcterms:modified xsi:type="dcterms:W3CDTF">{date}</dcterms:modified><cp:revision>1</cp:revision></cp:coreProperties>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>{sheets}',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><dimension ref="{ref}"/><cols>{cols}</cols><sheetData>{rows}</sheetData></worksheet>',"xl/sharedStrings.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="{cnt}" uniqueCount="{cnt}">{strings}</sst>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><fonts count="2"><font><name val="Calibri"/><family val="2"/></font><font><name val="Calibri"/><family val="2"/><b/></font></fonts><fills count="1"><fill><patternFill patternType="none"/></fill></fills><borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="8"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="9" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="10" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="14" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="20" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="22" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1" applyAlignment="1"><alignment horizontal="right"/></xf>\t<xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles></styleSheet>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="FrostUI-Tables"/><sheets>{sheets}</sheets></workbook>'},i.Workbook=o;class a{constructor(t,e=0){this._buffer=t,this._index=e,this._bitIndex=0,this._buffer.length<=this._index&&this._expandBuffer()}finish(){let t=this._index;return this._bitIndex>0&&(this._buffer[t]<<=8-this._bitIndex,this._buffer[t]=this.constructor._reverseTable[this._buffer[t]],t++),this._buffer.subarray(0,t)}writeBits(t,e,s){s&&e>1&&(t=e>8?this.constructor.rev32(t)>>32-e:this.constructor._reverseTable[t]>>8-e);let i=this._buffer[this._index];if(e+this._bitIndex<8)i=i<<e|t,this._bitIndex+=e;else for(let s=0;s<e;s++)i=i<<1|t>>e-s-1&1,8==++this._bitIndex&&(this._bitIndex=0,this._buffer[this._index++]=this.constructor._reverseTable[i],i=0,this._index===this._buffer.length&&this._expandBuffer());this._buffer[this._index]=i}_expandBuffer(){const t=this._buffer,e=t.length;this._buffer=new Uint8Array(e<<1),this._buffer.set(t)}static rev32(t){return this._reverseTable[255&t]<<24|this._reverseTable[t>>>8&255]<<16|this._reverseTable[t>>>16&255]<<8|this._reverseTable[t>>>24&255]}static get _reverseTable(){if(!this.__reverseTable){this.__reverseTable=new Uint8Array(256);for(let t=0;t<256;++t){let e=t,s=e,i=7;for(e>>>=1;e;e>>>=1)s<<=1,s|=1&e,--i;this.__reverseTable[t]=(s<<i&255)>>>0}}return this.__reverseTable}}class l{static calc(t,e=0,s=null){return this.update(t,0,e,s)}static update(t,e,s=0,i=null){null===i&&(i=t.length),e^=4294967295;for(let n=7&i;n--;++s)e=e>>>8^this._table[255&(e^t[s])];for(let n=i>>3;n--;s+=8)e=(e=(e=(e=(e=(e=(e=(e=e>>>8^this._table[255&(e^t[s])])>>>8^this._table[255&(e^t[s+1])])>>>8^this._table[255&(e^t[s+2])])>>>8^this._table[255&(e^t[s+3])])>>>8^this._table[255&(e^t[s+4])])>>>8^this._table[255&(e^t[s+5])])>>>8^this._table[255&(e^t[s+6])])>>>8^this._table[255&(e^t[s+7])];return(4294967295^e)>>>0}static get _table(){if(!this.__table){this.__table=new Uint32Array(256);for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;this.__table[t]=e>>>0}}return this.__table}}class h{constructor(t){this._buffer=new Uint16Array(2*t),this.length=0}pop(){const t=this._buffer[0],e=this._buffer[1];this.length-=2,this._buffer[0]=this._buffer[this.length],this._buffer[1]=this._buffer[this.length+1];let s=0;for(;;){let t=this.constructor._getChild(s);if(t>=this.length)break;if(t+2<this.length&&this._buffer[t+2]>this._buffer[t]&&(t+=2),!(this._buffer[t]>this._buffer[s]))break;{let e=this._buffer[s];this._buffer[s]=this._buffer[t],this._buffer[t]=e,e=this._buffer[s+1],this._buffer[s+1]=this._buffer[t+1],this._buffer[t+1]=e}s=t}return{index:e,value:t}}push(t,e){let s=this.length;for(this._buffer[this.length++]=e,this._buffer[this.length++]=t;s>0;){const t=this.constructor._getParent(s);if(!(this._buffer[s]>this._buffer[t]))break;{let e=this._buffer[s];this._buffer[s]=this._buffer[t],this._buffer[t]=e,e=this._buffer[s+1],this._buffer[s+1]=this._buffer[t+1],this._buffer[t+1]=e,s=t}}}static _getParent(t){return 2*((t-2)/4|0)}static _getChild(t){return 2*t+2}}class c{constructor(t,e){this.length=t,this._backwardDistance=e}toLz77Array(){const t=[];let e=0;const s=this.constructor._lengthCodeTable[this.length];t[e++]=65535&s,t[e++]=s>>16&255,t[e++]=s>>24;const i=this.constructor._getDistanceCode(this._backwardDistance);return t[e++]=i[0],t[e++]=i[1],t[e++]=i[2],t}static _getDistanceCode(t){switch(!0){case 1===t:return[0,t-1,0];case 2===t:return[1,t-2,0];case 3===t:return[2,t-3,0];case 4===t:return[3,t-4,0];case t<=6:return[4,t-5,1];case t<=8:return[5,t-7,1];case t<=12:return[6,t-9,2];case t<=16:return[7,t-13,2];case t<=24:return[8,t-17,3];case t<=32:return[9,t-25,3];case t<=48:return[10,t-33,4];case t<=64:return[11,t-49,4];case t<=96:return[12,t-65,5];case t<=128:return[13,t-97,5];case t<=192:return[14,t-129,6];case t<=256:return[15,t-193,6];case t<=384:return[16,t-257,7];case t<=512:return[17,t-385,7];case t<=768:return[18,t-513,8];case t<=1024:return[19,t-769,8];case t<=1536:return[20,t-1025,9];case t<=2048:return[21,t-1537,9];case t<=3072:return[22,t-2049,10];case t<=4096:return[23,t-3073,10];case t<=6144:return[24,t-4097,11];case t<=8192:return[25,t-6145,11];case t<=12288:return[26,t-8193,12];case t<=16384:return[27,t-12289,12];case t<=24576:return[28,t-16385,13];case t<=32768:return[29,t-24577,13]}}static _getLengthCode(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0]}}static get _lengthCodeTable(){if(!this.__lengthCodeTable){this.__lengthCodeTable=[];for(let t=3;t<=258;t++){const e=this._getLengthCode(t);this.__lengthCodeTable[t]=e[2]<<24|e[1]<<16|e[0]}}return this.__lengthCodeTable}}class d{constructor(t,e){e={lazy:0,lz77MinLength:3,lz77MaxLength:258,...e},this._input=t,this._lazy=e.lazy,this._lz77MinLength=e.lz77MinLength,this._lz77MaxLength=e.lz77MaxLength,this._outputIndex=0,this._output=new Uint8Array(32768)}compress(){const t=new a(new Uint8Array(this._output.buffer),this._outputIndex);t.writeBits(1,1,!0),t.writeBits(2,2,!0);const e=this._lz77(),s=this.constructor._getLengths(this.freqsLitLen,15),i=this.constructor._getCodesFromLengths(s),n=this.constructor._getLengths(this.freqsDist,7),r=this.constructor._getCodesFromLengths(n);let o,l;for(o=286;o>257&&0===s[o-1];o--);for(l=30;l>1&&0===n[l-1];l--);const h=this.constructor._getTreeSymbols(o,s,l,n),c=this.constructor._getLengths(h.freqs,7),d=new Array(19),u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];for(let t=0;t<19;t++)d[t]=c[u[t]];let _;for(_=19;_>4&&0===d[_-1];_--);const g=this.constructor._getCodesFromLengths(c);t.writeBits(o-257,5,!0),t.writeBits(l-1,5,!0),t.writeBits(_-4,4,!0);for(let e=0;e<_;e++)t.writeBits(d[e],3,!0);for(let e=0;e<h.codes.length;e++){const s=h.codes[e];if(t.writeBits(g[s],c[s],!0),s>=16){let i;switch(e++,s){case 16:i=2;break;case 17:i=3;break;case 18:i=7}t.writeBits(h.codes[e],i,!0)}}for(let o=0;o<e.length;o++){const a=e[o];if(t.writeBits(i[a],s[a],!0),a>256){t.writeBits(e[++o],e[++o],!0);const s=e[++o];t.writeBits(r[s],n[s],!0),t.writeBits(e[++o],e[++o],!0)}else if(256===a)break}return this._output=t.finish(),this._outputIndex=this._output.length,this._output}static compress(t,e){return new this(t,e).compress()}_lz77(){const t=new Uint16Array(2*this._input.length),e=new Uint32Array(286),s=new Uint32Array(30);e[256]=1;const i={};let n,r=0,o=0;const a=(i,a)=>{const l=i.toLz77Array();for(let e=0;e<l.length;e++)t[r++]=l[e];e[l[0]]++,s[l[3]]++,o=i.length+a-1,n=null};for(let s=0;s<this._input.length;s++){let l=0;for(let t=0;t<this._lz77MinLength&&s+t!==this._input.length;t++)l=l<<8|this._input[s+t];l in i||(i[l]=[]);const h=i[l];if(o-- >0)h.push(s);else{for(;h.length>0&&s-h[0]>32768;)h.shift();if(s+this._lz77MinLength>=this._input.length){n&&a(n,-1);for(let i=0;i<this._input.length-s;i++){const n=this._input[s+i];t[r++]=n,e[n]++}break}if(h.length){const i=this._searchLongestMatch(s,h);if(n)if(n.length<i.length){const n=this._input[s-1];t[r++]=n,e[n]++,a(i,0)}else a(n,-1);else i.length<this._lazy?n=i:a(i,0)}else if(n)a(n,-1);else{const i=this._input[s];t[r++]=i,e[i]++}h.push(s)}}return t[r++]=256,e[256]++,this.freqsLitLen=e,this.freqsDist=s,t.subarray(0,r)}_searchLongestMatch(t,e){let s,i=0;const n=e.length;t:for(let r=0;r<n;r++){const o=e[n-r-1];let a=this._lz77MinLength;if(i>this._lz77MaxLength){for(j=i;j>this._lz77MinLength;j--)if(this._input[o+j-1]!==this._input[t+j-1])continue t;a=i}for(;a<this._lz77MaxLength&&t+a<n&&this._input[o+a]===this._input[t+a];)a++;if(a>i&&(s=o,i=a),a===this._lz77MaxLength)break}return new c(i,t-s)}static _getCodesFromLengths(t){const e=new Uint16Array(t.length),s=[],i=[];let n=0;for(let e=0;e<t.length;e++)s[t[e]]=1+(0|s[t[e]]);for(let t=1;t<=16;t++)i[t]=n,n+=0|s[t],n<<=1;for(let s=0;s<t.length;s++){n=i[t[s]],i[t[s]]+=1,e[s]=0;for(let i=0;i<t[s];i++)e[s]=e[s]<<1|1&n,n>>>=1}return e}static _getLengths(t,e){const s=new h(572),i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)t[e]>0&&s.push(e,t[e]);const n=new Array(s.length/2),r=new Uint32Array(s.length/2);if(1===n.length)return i[s.pop().index]=1,i;for(let t=0;t<n.length;t++)n[t]=s.pop(),r[t]=n[t].value;const o=this._reversePackageMerge(r,r.length,e);for(let t=0;t<n.length;t++)i[n[t].index]=o[t];return i}static _getTreeSymbols(t,e,s,i){const n=new Uint32Array(t+s),r=new Uint32Array(316),o=new Uint8Array(19);let a=0;for(let s=0;s<t;s++)n[a++]=e[s];for(let t=0;t<s;t++)n[a++]=i[t];let l=0;for(let t=0;t<n.length;t+=a){for(a=1;t+a<n.length&&n[t+a]===n[t];a++);let e=a;if(0===n[t])if(e<3)for(;e-- >0;)r[l++]=0,o[0]++;else for(;e>0;){let t=Math.min(e,138);t>e-3&&t<e&&(t=e-3),t<=10?(r[l++]=17,r[l++]=t-3,o[17]++):(r[l++]=18,r[l++]=t-11,o[18]++),e-=t}else if(r[l++]=n[t],o[n[t]]++,e--,e<3)for(;e-- >0;)r[l++]=n[t],o[n[t]]++;else for(;e>0;){let t=Math.min(e,6);t>e-3&&t<e&&(t=e-3),r[l++]=16,r[l++]=t-3,o[16]++,e-=t}}return{codes:r.subarray(0,l),freqs:o}}static _reversePackageMerge(t,e,s){const i=new Uint16Array(s),n=new Uint8Array(s),r=new Uint8Array(e),o=new Array(s),a=new Array(s),l=new Array(s);let h=(1<<s)-e;const c=1<<s-1;i[s-1]=e;for(let t=0;t<s;t++)h<c?n[t]=0:(n[t]=1,h-=c),h<<=1,i[s-2-t]=(i[s-1-t]/2|0)+e;i[0]=n[0],o[0]=new Array(i[0]),a[0]=new Array(i[0]);for(let t=0;t<s;t++)i[t]>2*i[t-1]+n[t]&&(i[t]=2*i[t-1]+n[t]),o[t]=new Array(i[t]),a[t]=new Array(i[t]);for(let t=0;t<e;t++)r[t]=s;for(let e=0;e<i[s-1];e++)o[s-1][e]=t[e],a[s-1][e]=e;for(let t=0;t<s;t++)l[t]=0;1===n[s-1]&&(r[0]--,l[s-1]++);const d=t=>{const s=a[t][l[t]];s===e?(d(t+1),d(t+1)):r[s]--,l[t]++};for(let r=s-2;r>=0;r--){let s=0,h=l[r+1];for(let n=0;n<i[r];n++){const i=o[r+1][h]+o[r+1][h+1];i>t[s]?(o[r][n]=i,a[r][n]=e,h+=2):(o[r][n]=t[s],a[r][n]=s,s++)}l[r]=0,1===n[r]&&d(r)}return r}}class u{constructor(t="octet/stream"){this._type=t,this._dir=[],this._files=[],this._offset=0,this._entries=0,this._encoder=new TextEncoder}addFile(t,e){const s=this._length(t),i=(e=this._encode(e)).byteLength,n=l.calc(e);let r=i,o=0;i>=256&&(r=(e=d.compress(e)).byteLength,o=8);const a=new Date;let h=a.getSeconds();h>=32&&(h-=32);let c=a.getYear()-1980;const u=`${h.toString(2)}`.padStart(5,"0"),_=`${a.getMinutes().toString(2)}`.padStart(6,"0"),g=`${a.getHours().toString(2)}`.padStart(5,"0"),p=`${a.getDate().toString(2)}`.padStart(5,"0"),f=`${a.getMonth().toString(2)}`.padStart(4,"0"),m=`${c.toString(2)}`.padStart(7,"0"),b=parseInt(`${g}${_}${u}`,2),x=parseInt(`${m}${f}${p}`,2),y=[this._encode("PK"),this._signed16(0),this._signed16(10),this._signed16(0),this._signed16(o),this._signed16(b),this._signed16(x),this._signed32(n),this._signed32(r),this._signed32(i),this._signed16(s),this._signed16(0),this._signed16(0),this._signed16(0),this._signed16(0),this._signed32(32),this._signed32(this._offset),this._encode(t)];this._dir.push(...y);const I=[this._encode("PK"),this._signed16(10),this._signed16(0),this._signed16(o),this._signed16(b),this._signed16(x),this._signed32(n),this._signed32(r),this._signed32(i),this._signed16(s),this._signed16(0),this._encode(t),e];return this._files.push(...I),this._offset+=I.reduce(((t,e)=>t+e.byteLength),0),this._entries++,this}zip(){const t=this._dir.reduce(((t,e)=>t+e.byteLength),0);return new Blob([...this._files,...this._dir,this._encode("PK"),this._signed16(0),this._signed16(0),this._signed16(this._entries),this._signed16(this._entries),this._signed32(t),this._signed32(this._offset),this._signed16(0)],{type:this._type})}_encode(t){return this._encoder.encode(t)}_length(t){return this._encode(t).length}_signed16(t){return new Int16Array([t])}_signed32(t){return new Int32Array([t])}}i.Zip={BitStream:a,CRC32:l,Heap:h,Lz77Match:c,RawDeflate:d,Zip:u}}));